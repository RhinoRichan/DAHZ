jQuery(function(a){a(".tooltip").popup({className:{popup:"ui popup small"}});var b=a("#customize-preview");a(".wp-full-overlay-header").append('<div id="df-customizer-tools"></div>');var c=a("#df-customizer-tools");c.append('<button id="trigger-overlay" class="button">Custom CSS</button>'),b.prepend('<div id="overlay-customcss"><form><textarea id="csstextarea"></textarea></form></div>');var d=a("#customize-preview #overlay-customcss"),e=a("#customize-preview #overlay-customcss form textarea"),f=a("li#customize-control-df_options-custom_styles").children().children("textarea");a("#trigger-overlay").click(function(b){b.preventDefault(),a(this).hasClass("btn-active")?(a(this).removeClass("btn-active"),d.fadeToggle("fast"),f.val(e.val()).keyup()):(a(this).addClass("btn-active"),d.fadeToggle("fast"),e.val(""),e.focus(),e.val(f.val()))}),HTMLTextAreaElement.prototype.getCaretPosition=function(){return this.selectionStart},HTMLTextAreaElement.prototype.setCaretPosition=function(a){this.selectionStart=a,this.selectionEnd=a,this.focus()},HTMLTextAreaElement.prototype.hasSelection=function(){return this.selectionStart==this.selectionEnd?!1:!0},HTMLTextAreaElement.prototype.getSelectedText=function(){return this.value.substring(this.selectionStart,this.selectionEnd)},HTMLTextAreaElement.prototype.setSelection=function(a,b){this.selectionStart=a,this.selectionEnd=b,this.focus()};var g=document.getElementById("csstextarea");g.onkeydown=function(a){if(9==a.keyCode){var b;return b=g.getCaretPosition()+"    ".length,g.value=g.value.substring(0,g.getCaretPosition())+"    "+g.value.substring(g.getCaretPosition(),g.value.length),g.setCaretPosition(b),!1}if(8==a.keyCode&&"    "==g.value.substring(g.getCaretPosition()-4,g.getCaretPosition())){var b;b=g.getCaretPosition()-3,g.value=g.value.substring(0,g.getCaretPosition()-3)+g.value.substring(g.getCaretPosition(),g.value.length),g.setCaretPosition(b)}if(37==a.keyCode){var b;"    "==g.value.substring(g.getCaretPosition()-4,g.getCaretPosition())&&(b=g.getCaretPosition()-3,g.setCaretPosition(b))}if(39==a.keyCode){var b;"    "==g.value.substring(g.getCaretPosition()+4,g.getCaretPosition())&&(b=g.getCaretPosition()+3,g.setCaretPosition(b))}}});